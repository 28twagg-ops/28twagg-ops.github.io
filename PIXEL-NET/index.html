<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PIXEL-NET ARCADE</title>
    <link rel="icon" type="image/png" href="assets/millipede_thumb.png">
    <style>
        /* --- THE RETRO AESTHETIC --- */
        body {
            background-color: #050505;
            color: #0f0;
            font-family: 'Courier New', monospace;
            margin: 0; padding: 0; overflow-x: hidden;
        }
        body::after {
            content: " "; display: block; position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2; background-size: 100% 2px, 3px 100%; pointer-events: none;
        }

        /* --- LAYOUT --- */
        .header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 30px; border-bottom: 2px solid #0f0;
            box-shadow: 0 0 10px #0f0; background: #000;
        }
        .logo { font-size: 1.8em; font-weight: bold; text-shadow: 2px 2px #ff00ff; letter-spacing: 2px; }

        .container {
            max-width: 1200px; margin: 0 auto; padding: 20px;
            display: grid; grid-template-columns: 3fr 1.2fr; gap: 30px;
        }

        /* --- HERO SECTION --- */
        .hero-section {
            border: 2px solid #ff00ff; padding: 40px 20px;
            text-align: center; margin-bottom: 30px; 
            box-shadow: 0 0 15px #ff00ff;
            background-color: #000; background-size: cover; background-position: center;
            position: relative; min-height: 200px; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
        }
        .hero-overlay { position: absolute; inset: 0; background: rgba(0, 0, 0, 0.7); z-index: 1; }
        .hero-content { position: relative; z-index: 2; }

        /* --- SEARCH --- */
        .library-controls {
            display: flex; flex-direction: column; gap: 10px;
            margin-bottom: 20px; border-bottom: 1px dashed #333; padding-bottom: 15px;
        }
        #gameSearch {
            background: #000; border: 1px solid #0f0; color: #0f0;
            padding: 10px; font-family: 'Courier New', monospace; 
            width: 100%; box-sizing: border-box; font-size: 1em; outline: none;
        }

        /* --- GAME GRID --- */
        .game-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; }
        .cabinet {
            border: 1px solid #333; padding: 10px; text-align: center;
            transition: 0.3s; cursor: pointer; background: #0a0a0a; position: relative;
        }
        .cabinet:hover { border-color: #0f0; transform: translateY(-5px); box-shadow: 0 0 25px rgba(0, 255, 0, 0.4); }

        .cabinet-screen {
            width: 100%; height: 200px; background-color: #000; margin-bottom: 12px;
            display: flex; align-items: center; justify-content: center;
            border: 1px solid #333; overflow: hidden;
        }
        .cabinet-thumb { 
            width: 100%; height: 100%; object-fit: contain;
            filter: saturate(75%) brightness(0.9); transition: 0.4s ease;
        }
        .cabinet:hover .cabinet-thumb { filter: saturate(100%) brightness(1.2); }

        /* --- SIDEBAR --- */
        .stats-panel { 
            border: 1px solid #0ff; padding: 15px; height: fit-content; 
            box-shadow: 0 0 10px #0ff; background: rgba(0, 255, 255, 0.05);
        }
        .section-title { color: #0ff; border-bottom: 2px solid #0ff; padding-bottom: 5px; margin-bottom: 15px; }
        .legend-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9em; border-bottom: 1px dashed #222; }

        /* --- LOGIN & OVERLAY --- */
        .login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 20; display: flex; justify-content: center; align-items: center; flex-direction: column;
        }
        #gameOverlay {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            z-index: 100; flex-direction: column; align-items: center; justify-content: center;
        }
        .game-frame { border: 4px solid #fff; box-shadow: 0 0 50px #fff; background: #000; }
        .close-btn { margin-top: 20px; padding: 10px 30px; background: transparent; color: red; border: 2px solid red; cursor: pointer; }
    </style>
</head>
<body>

    <div id="loginGate" class="login-overlay">
        <div style="text-align: center; border: 2px solid #0f0; padding: 40px; background: #000;">
            <h1>INSERT COIN</h1>
            <p>ENTER INITIALS</p>
            <input type="text" id="initialsInput" maxlength="3" style="background:#111; border:2px solid #0f0; color:#0f0; font-size:2em; text-align:center; width:150px; outline:none;">
            <br><br>
            <button onclick="enterArcade()" style="background:#0f0; padding:10px 30px; border:none; cursor:pointer; font-weight:bold;">START</button>
        </div>
    </div>

    <div class="header">
        <div class="logo">üïπÔ∏è PIXEL-NET</div>
        <div id="playerDisplay">PLAYER: ???</div>
    </div>

    <div class="container">
        <div class="main-content">
            <div class="hero-section" id="heroBanner" style="display:none;">
                <div class="hero-overlay"></div>
                <div class="hero-content">
                    <h2 id="heroTitle">üî• FEATURED</h2>
                    <p id="heroSubtitle"></p>
                    <button id="heroButton" style="background:#ff00ff; border:none; padding:12px 30px; color:white; cursor:pointer; font-weight:bold;">‚ñ∂ PLAY NOW</button>
                </div>
            </div>

            <div class="library-controls">
                <h3>// GAME LIBRARY</h3>
                <input type="text" id="gameSearch" placeholder="SEARCH TITLES..." onkeyup="filterGames()">
            </div>

            <div class="game-grid" id="arcadeGrid"></div>
        </div>

        <div class="stats-panel">
            <div class="section-title">üèÜ THE IMMOVABLE DOGS</div>
            <div class="legend-row"><span>1. ASH</span><span>99,400</span></div>
            <div class="legend-row"><span>2. KAI</span><span>98,100</span></div>
            <div class="legend-row"><span>3. BOB</span><span>85,000</span></div>
            <br>
            <div class="section-title" style="color:#ff00ff; border-color:#ff00ff;">üöÄ BIG MOVERS</div>
            <div style="border-left:2px solid #ff00ff; padding-left:10px;">
                <div>ZED (Space Rocks)</div>
                <div style="color:#0f0;">+11,500</div>
            </div>
        </div>
    </div>

    <div id="gameOverlay">
        <div class="game-frame">
            <canvas id="gameCanvas" width="400" height="640"></canvas>
        </div>
        <button class="close-btn" onclick="closeGame()">[ EJECT CARTRIDGE ]</button>
    </div>

    <script>
        async function loadGames() {
            try {
                // IMPORTANT: Fetch from the current folder
                const response = await fetch('games.json');
                const games = await response.json();
                const grid = document.getElementById('arcadeGrid');
                grid.innerHTML = '';

                games.forEach(game => {
                    const cab = document.createElement('div');
                    cab.className = 'cabinet';
                    cab.setAttribute('data-name', game.title.toLowerCase());
                    cab.innerHTML = `
                        <div class="cabinet-screen"><img src="${game.image}" class="cabinet-thumb"></div>
                        <div style="font-weight:bold;">${game.title}</div>
                        <div style="font-size:0.8em; color:#888;">${game.description}</div>
                    `;
                    cab.onclick = () => launchGame(game.script);
                    grid.appendChild(cab);
                });

                if(games.length > 0) {
                    const hero = games[0];
                    const banner = document.getElementById('heroBanner');
                    banner.style.display = 'flex';
                    banner.style.backgroundImage = `url('${hero.image}')`;
                    document.getElementById('heroTitle').innerText = "üî• FEATURE: " + hero.title;
                    document.getElementById('heroSubtitle').innerText = hero.description;
                    document.getElementById('heroButton').onclick = () => launchGame(hero.script);
                }
            } catch (e) { console.error("Load Error:", e); }
        }

        function launchGame(scriptPath) {
            // Path Correction for sub-folder structure
            let path = scriptPath;
            if(!path.startsWith('js/')) path = 'js/' + path;
            
            const old = document.getElementById('active-cart');
            if(old) old.remove();

            const script = document.createElement('script');
            script.src = path;
            script.id = 'active-cart';
            script.onerror = () => alert("ERROR: Could not find " + path);
            document.body.appendChild(script);
            document.getElementById('gameOverlay').style.display = 'flex';
        }

        function closeGame() { document.getElementById('gameOverlay').style.display = 'none'; window.location.reload(); }
        function enterArcade() { document.getElementById('loginGate').style.display = 'none'; }
        function filterGames() {
            const term = document.getElementById("gameSearch").value.toLowerCase();
            document.querySelectorAll(".cabinet").forEach(c => {
                c.style.display = c.getAttribute("data-name").includes(term) ? "" : "none";
            });
        }
        window.onload = loadGames;
    </script>
</body>
</html>
